const e=(e,t)=>{e.attrs=e.attrs?.filter(([e])=>e!==t)??null},t=t=>{let n=t.attrs?.find(([e])=>e===`title`)?.[1];return n?(e(t,`title`),n):t.content},n=(e,n={})=>{e.core.ruler.before(`linkify`,`figure`,r=>{for(let i=1,{length:a}=r.tokens;i<a-1;i++){let a=r.tokens[i];if(a.type!==`inline`||!a.children||a.children.length!==1&&a.children.length!==3||a.children.length===1&&a.children[0].type!==`image`)continue;if(a.children.length===3){let[e,t,n]=a.children;if(e.type!==`link_open`||t.type!==`image`||n.type!==`link_close`)continue}if(r.tokens[i-1].type!==`paragraph_open`||r.tokens[i+1].type!==`paragraph_close`)continue;let o=r.tokens[i-1];o.type=`figure_open`,o.tag=`figure`,r.tokens[i+1].type=`figure_close`,r.tokens[i+1].tag=`figure`;let s=a.children.length===1?a.children[0]:a.children[1],c=t(s),[l]=e.parseInline(c,r.env);a.children.push(new r.Token(`figcaption_open`,`figcaption`,1)),a.children.push(...l.children??[]),a.children.push(new r.Token(`figcaption_close`,`figcaption`,-1)),n.focusable!==!1&&s.attrPush([`tabindex`,`0`])}})};export{n as figure};
//# sourceMappingURL=index.js.map