const e=(e,t)=>{let n=e.pos,r=e.src.charCodeAt(n);if(t||r!==61)return!1;let i=e.scanDelims(e.pos,!0),a=i.length;if(a<2)return!1;let o=String.fromCharCode(r);if(a%2){let t=e.push(`text`,``,0);t.content=o,a--}for(let t=0;t<a;t+=2){let t=e.push(`text`,``,0);t.content=o+o,(i.can_open||i.can_close)&&e.delimiters.push({marker:61,length:0,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close})}return e.pos+=i.length,!0},t=(e,t)=>{let n,r=[],i=t.length;for(let a=0;a<i;a++){let i=t[a];if(i.marker===61&&i.end!==-1){let a=t[i.end];n=e.tokens[i.token],n.type=`mark_open`,n.tag=`mark`,n.nesting=1,n.markup=`==`,n.content=``,n=e.tokens[a.token],n.type=`mark_close`,n.tag=`mark`,n.nesting=-1,n.markup=`==`,n.content=``,e.tokens[a.token-1].type===`text`&&e.tokens[a.token-1].content===`=`&&r.push(a.token-1)}}for(;r.length>0;){let t=r.pop(),i=t+1;for(;i<e.tokens.length&&e.tokens[i].type===`mark_close`;)i++;i--,t!==i&&(n=e.tokens[i],e.tokens[i]=e.tokens[t],e.tokens[t]=n)}},n=n=>{n.inline.ruler.before(`emphasis`,`mark`,e),n.inline.ruler2.before(`emphasis`,`mark`,e=>{t(e,e.delimiters);let n=e.tokens_meta,r=n.length;if(r===0)return!0;for(let i=0;i<r;i++){let r=n[i];r?.delimiters.length&&t(e,r.delimiters)}return!0})};export{n as mark};
//# sourceMappingURL=index.js.map