{"version":3,"file":"index.js","names":[],"sources":["../src/plugin.ts"],"sourcesContent":["/**\n * Forked from https://github.com/markdown-it/markdown-it-footnote/blob/master/index.mjs\n */\n\nimport type { PluginSimple } from \"markdown-it\";\nimport type { RuleBlock } from \"markdown-it/lib/parser_block.mjs\";\nimport type { RuleCore } from \"markdown-it/lib/parser_core.mjs\";\nimport type { RuleInline } from \"markdown-it/lib/parser_inline.mjs\";\nimport type { RenderRule } from \"markdown-it/lib/renderer.mjs\";\nimport type { ParentType } from \"markdown-it/lib/rules_block/state_block.mjs\";\nimport type StateBlock from \"markdown-it/lib/rules_block/state_block.mjs\";\nimport type StateCore from \"markdown-it/lib/rules_core/state_core.mjs\";\nimport type StateInline from \"markdown-it/lib/rules_inline/state_inline.mjs\";\nimport type Token from \"markdown-it/lib/token.mjs\";\n\nimport type { FootNoteEnv, FootNoteToken } from \"./types.js\";\n\ninterface FootNoteStateBlock extends StateBlock {\n  tokens: FootNoteToken[];\n  env: FootNoteEnv;\n}\n\ninterface FootNoteStateInline extends StateInline {\n  tokens: FootNoteToken[];\n  env: FootNoteEnv;\n}\n\ninterface FootNoteStateCore extends StateCore {\n  tokens: FootNoteToken[];\n  env: FootNoteEnv;\n}\n\nconst getIDSuffix = (tokens: FootNoteToken[], index: number): string =>\n  // add suffix when multiple id was found\n  tokens[index].meta.subId > 0 ? `:${tokens[index].meta.subId}` : \"\";\n\nconst renderFootnoteAnchorName: RenderRule = (\n  tokens: FootNoteToken[],\n  index,\n  _options,\n  env: FootNoteEnv,\n): string =>\n  `${\n    // prefix\n    typeof env.docId === \"string\" ? `-${env.docId}-` : \"\"\n  }${\n    // increasing id\n    (tokens[index].meta.id + 1).toString()\n  }`;\n\nconst renderFootnoteCaption: RenderRule = (tokens: FootNoteToken[], index): string =>\n  `[${\n    // number\n    (tokens[index].meta.id + 1).toString()\n  }${getIDSuffix(tokens, index)}]`;\n\nconst renderFootnoteRef: RenderRule = (\n  tokens: FootNoteToken[],\n  index,\n  options,\n  env: FootNoteEnv,\n  self,\n): string => {\n  // oxlint-disable-next-line typescript/no-non-null-assertion\n  const id = self.rules.footnote_anchorName!(tokens, index, options, env, self);\n  // oxlint-disable-next-line typescript/no-non-null-assertion\n  const caption = self.rules.footnote_caption!(tokens, index, options, env, self);\n\n  return `<sup class=\"footnote-ref\"><a href=\"#footnote${id}\">${caption}</a><a class=\"footnote-anchor\" id=\"footnote-ref${id}${getIDSuffix(\n    tokens,\n    index,\n  )}\"></a></sup>`;\n};\n\nconst renderFootnoteBlockOpen: RenderRule = (_tokens: FootNoteToken[], _index, options): string =>\n  `\\\n<hr class=\"footnotes-sep\"${options.xhtmlOut ? \" /\" : \"\"}>\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n`;\n\nconst renderFootnoteBlockClose = (): string => `\\\n</ol>\n</section>\n`;\n\nconst renderFootnoteOpen: RenderRule = (\n  tokens: FootNoteToken[],\n  index,\n  options,\n  env: FootNoteEnv,\n  self,\n): string =>\n  // oxlint-disable-next-line typescript/no-non-null-assertion\n  `<li id=\"footnote${self.rules.footnote_anchorName!(\n    tokens,\n    index,\n    options,\n    env,\n    self,\n  )}${getIDSuffix(tokens, index)}\" class=\"footnote-item\">`;\n\nconst renderFootnoteClose = (): string => \"</li>\\n\";\n\nconst renderFootnoteAnchor: RenderRule = (\n  tokens: FootNoteToken[],\n  index,\n  options,\n  env: FootNoteEnv,\n  self,\n): string =>\n  // oxlint-disable-next-line typescript/no-non-null-assertion\n  ` <a href=\"#footnote-ref${self.rules.footnote_anchorName!(tokens, index, options, env, self)}${\n    getIDSuffix(tokens, index)\n    /* ↩ with escape code to prevent display as Apple Emoji on iOS */\n  }\" class=\"footnote-backref\">\\u21A9\\uFE0E</a>`;\n\n// Process footnote block definition\nconst footnoteDef: RuleBlock = (state: FootNoteStateBlock, startLine, endLine, silent) => {\n  const start = state.bMarks[startLine] + state.tShift[startLine];\n  const max = state.eMarks[startLine];\n  let char: number;\n\n  if (\n    // line should be at least 5 chars - \"[^x]:\"\n    start + 4 > max ||\n    state.src.charCodeAt(start) !== 91 /* [ */ ||\n    state.src.charCodeAt(start + 1) !== 94 /* ^ */\n  )\n    return false;\n\n  let pos = start + 2;\n\n  while (pos < max) {\n    char = state.src.charCodeAt(pos);\n    if (char === 32 /* space */) return false;\n\n    if (char === 93 /* ] */) break;\n\n    pos++;\n  }\n\n  if (\n    // empty footnote label\n    pos === start + 2 ||\n    pos + 1 >= max ||\n    state.src.charCodeAt(++pos) !== 58 /* : */\n  )\n    return false;\n\n  if (silent) return true;\n\n  pos++;\n\n  // oxlint-disable-next-line typescript/no-unnecessary-condition\n  (state.env.footnotes ??= {}).refs ??= {};\n\n  const label = state.src.slice(start + 2, pos - 2);\n\n  state.env.footnotes.refs[`:${label}`] = -1;\n\n  const referenceOpenToken = state.push(\"footnote_reference_open\", \"\", 1);\n\n  referenceOpenToken.meta = { label };\n  referenceOpenToken.level = state.level++;\n\n  const oldBMark = state.bMarks[startLine];\n  const oldTShift = state.tShift[startLine];\n  const oldSCount = state.sCount[startLine];\n  const oldParentType = state.parentType;\n  const posAfterColon = pos;\n  const initial =\n    state.sCount[startLine] + pos - (state.bMarks[startLine] + state.tShift[startLine]);\n\n  let offset = initial;\n\n  while (pos < max) {\n    const char = state.src.charCodeAt(pos);\n\n    if (char === 9 /* \\t */) offset += 4 - (offset % 4);\n    else if (char === 32 /* space */) offset++;\n    else break;\n\n    pos++;\n  }\n\n  state.tShift[startLine] = pos - posAfterColon;\n  state.sCount[startLine] = offset - initial;\n  state.bMarks[startLine] = posAfterColon;\n  state.blkIndent += 4;\n  state.parentType = \"footnote\" as unknown as ParentType;\n\n  if (state.sCount[startLine] < state.blkIndent) state.sCount[startLine] += state.blkIndent;\n\n  state.md.block.tokenize(state, startLine, endLine);\n\n  state.parentType = oldParentType;\n  state.blkIndent -= 4;\n  state.tShift[startLine] = oldTShift;\n  state.sCount[startLine] = oldSCount;\n  state.bMarks[startLine] = oldBMark;\n\n  const referenceCloseToken = state.push(\"footnote_reference_close\", \"\", -1);\n\n  referenceCloseToken.level = --state.level;\n\n  return true;\n};\n\n// Process inline footnotes (^[...])\nconst footnoteInline: RuleInline = (state: FootNoteStateInline, silent) => {\n  const max = state.posMax;\n  const start = state.pos;\n\n  if (\n    start + 2 >= max ||\n    state.src.charCodeAt(start) !== 94 /* ^ */ ||\n    state.src.charCodeAt(start + 1) !== 91 /* [ */\n  )\n    return false;\n\n  const labelEnd = state.md.helpers.parseLinkLabel(state, start + 1);\n\n  // parser failed to find ']', so it’s not a valid note\n  if (labelEnd < 0) return false;\n\n  const labelStart = start + 2;\n\n  /*\n   * We found the end of the link, and know for a fact it’s a valid link;\n   * so all that’s left to do is to call tokenizer.\n   *\n   */\n  if (!silent) {\n    // oxlint-disable-next-line typescript/no-unnecessary-condition\n    const list = ((state.env.footnotes ??= {}).list ??= []);\n    const footnoteId = list.length;\n    const tokens: Token[] = [];\n\n    state.md.inline.parse(state.src.slice(labelStart, labelEnd), state.md, state.env, tokens);\n\n    const refToken = state.push(\"footnote_ref\", \"\", 0);\n\n    refToken.meta = { id: footnoteId };\n\n    state.env.footnotes.list[footnoteId] = {\n      content: state.src.slice(labelStart, labelEnd),\n      tokens,\n    };\n  }\n\n  state.pos = labelEnd + 1;\n  state.posMax = max;\n\n  return true;\n};\n\n// Process footnote references ([^...])\nconst footnoteRef: RuleInline = (state: FootNoteStateInline, silent) => {\n  const start = state.pos;\n  const max = state.posMax;\n  let char: number;\n\n  if (\n    // should be at least 4 chars - \"[^x]\"\n    start + 3 > max ||\n    // oxlint-disable-next-line typescript/no-unnecessary-condition\n    !state.env.footnotes?.refs ||\n    state.src.charCodeAt(start) !== 91 /* [ */ ||\n    state.src.charCodeAt(start + 1) !== 94 /* ^ */\n  )\n    return false;\n\n  let pos = start + 2;\n\n  while (pos < max) {\n    char = state.src.charCodeAt(pos);\n    if (char === 32 /* space */ || char === 10 /* \\n */) return false;\n\n    if (char === 93 /* ] */) break;\n\n    pos++;\n  }\n\n  // empty footnote labels\n  if (pos === start + 2 || pos >= max) return false;\n\n  pos++;\n\n  const label = state.src.slice(start + 2, pos - 1);\n\n  if (state.env.footnotes.refs[`:${label}`] === undefined) return false;\n\n  if (!silent) {\n    const list = (state.env.footnotes.list ??= []);\n    const { refs } = state.env.footnotes;\n    let footnoteId: number;\n\n    if (refs[`:${label}`] < 0) {\n      footnoteId = list.length;\n      list[footnoteId] = { label, count: 0 };\n      refs[`:${label}`] = footnoteId;\n    } else {\n      footnoteId = refs[`:${label}`];\n    }\n\n    // oxlint-disable-next-line typescript/no-non-null-assertion\n    const subId = list[footnoteId].count!;\n\n    // oxlint-disable-next-line typescript/no-non-null-assertion\n    list[footnoteId].count! += 1;\n\n    const refToken = state.push(\"footnote_ref\", \"\", 0);\n\n    refToken.meta = { id: footnoteId, subId, label };\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n\n  return true;\n};\n\n// Glue footnote tokens to end of token stream\nconst footnoteTail: RuleCore = (state: FootNoteStateCore): boolean => {\n  const refTokens: Record<string, Token[]> = {};\n\n  let current: Token[];\n  let currentLabel: string;\n  let isInsideRef = false;\n\n  // oxlint-disable-next-line typescript/no-unnecessary-condition\n  if (!state.env.footnotes?.list) {\n    // If no footnotes list, remove all footnote reference tokens\n    state.tokens = state.tokens.filter((stateToken) => {\n      if (stateToken.type === \"footnote_reference_open\") {\n        isInsideRef = true;\n\n        return false;\n      }\n\n      if (stateToken.type === \"footnote_reference_close\") {\n        isInsideRef = false;\n\n        return false;\n      }\n\n      return !isInsideRef;\n    });\n\n    return false;\n  }\n\n  const { list } = state.env.footnotes;\n\n  state.tokens = state.tokens.filter((stateToken) => {\n    if (stateToken.type === \"footnote_reference_open\") {\n      isInsideRef = true;\n      current = [];\n      currentLabel = stateToken.meta.label;\n\n      return false;\n    }\n\n    if (stateToken.type === \"footnote_reference_close\") {\n      isInsideRef = false;\n      // prepend ':' to avoid conflict with Object.prototype members\n      refTokens[`:${currentLabel}`] = current;\n\n      return false;\n    }\n    if (isInsideRef) current.push(stateToken);\n\n    return !isInsideRef;\n  });\n\n  const footnoteBlockOpenToken = new state.Token(\"footnote_block_open\", \"\", 1);\n\n  state.tokens.push(footnoteBlockOpenToken);\n\n  for (let index = 0, { length } = list; index < length; index++) {\n    const footnoteOpenToken = new state.Token(\"footnote_open\", \"\", 1);\n\n    footnoteOpenToken.meta = { id: index, label: list[index].label };\n    state.tokens.push(footnoteOpenToken);\n\n    let lastParagraph: FootNoteToken | null;\n\n    if (list[index].tokens) {\n      const paragraphOpenToken = new state.Token(\"paragraph_open\", \"p\", 1);\n\n      paragraphOpenToken.block = true;\n\n      const inlineToken = new state.Token(\"inline\", \"\", 0);\n\n      // oxlint-disable-next-line typescript/no-non-null-assertion\n      inlineToken.children = list[index].tokens!;\n      // oxlint-disable-next-line typescript/no-non-null-assertion\n      inlineToken.content = list[index].content!;\n\n      const paragraphCloseToken = new state.Token(\"paragraph_close\", \"p\", -1);\n\n      paragraphCloseToken.block = true;\n\n      state.tokens.push(paragraphOpenToken, inlineToken, paragraphCloseToken);\n    } else if (list[index].label) {\n      // oxlint-disable-next-line typescript/no-non-null-assertion\n      const tokens = refTokens[`:${list[index].label!}`];\n\n      // oxlint-disable-next-line typescript/no-unnecessary-condition\n      if (tokens) state.tokens.push(...tokens);\n    }\n\n    if (state.tokens[state.tokens.length - 1].type === \"paragraph_close\")\n      lastParagraph = state.tokens.pop() ?? null;\n    else lastParagraph = null;\n\n    for (\n      let j = 0;\n      // oxlint-disable-next-line typescript/no-non-null-assertion\n      j < (Number(list[index].count) > 0 ? list[index].count! : 1);\n      j++\n    ) {\n      const footnoteAnchorToken = new state.Token(\"footnote_anchor\", \"\", 0);\n\n      footnoteAnchorToken.meta = {\n        id: index,\n        subId: j,\n        label: list[index].label,\n      };\n      state.tokens.push(footnoteAnchorToken);\n    }\n\n    if (lastParagraph) state.tokens.push(lastParagraph);\n\n    state.tokens.push(new state.Token(\"footnote_close\", \"\", -1));\n  }\n\n  state.tokens.push(new state.Token(\"footnote_block_close\", \"\", -1));\n\n  return true;\n};\n\nexport const footnote: PluginSimple = (md) => {\n  md.renderer.rules.footnote_ref = renderFootnoteRef;\n  md.renderer.rules.footnote_block_open = renderFootnoteBlockOpen;\n  md.renderer.rules.footnote_block_close = renderFootnoteBlockClose;\n  md.renderer.rules.footnote_open = renderFootnoteOpen;\n  md.renderer.rules.footnote_close = renderFootnoteClose;\n  md.renderer.rules.footnote_anchor = renderFootnoteAnchor;\n\n  // helpers (only used in other rules, no tokens are attached to those)\n  // helpers (only used in other rules, no tokens are attached to those)\n  md.renderer.rules.footnote_caption = renderFootnoteCaption;\n  md.renderer.rules.footnote_anchorName = renderFootnoteAnchorName;\n\n  md.block.ruler.before(\"reference\", \"footnoteDef\", footnoteDef, {\n    alt: [\"paragraph\", \"reference\"],\n  });\n  md.inline.ruler.after(\"image\", \"footnoteInline\", footnoteInline);\n  md.inline.ruler.after(\"footnoteInline\", \"footnote_ref\", footnoteRef);\n  md.core.ruler.after(\"inline\", \"footnoteTail\", footnoteTail);\n};\n"],"mappings":"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"}